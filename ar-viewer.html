<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>AR Viewer</title>
    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>
    <style>
      body {
        margin: 0;
        background: linear-gradient(
          to bottom,
          #87ceeb,
          #1e90ff
        ); /* D√©grad√© bleu pour simuler l'eau */
        font-family: Arial;
        text-align: center;
        min-height: 100vh;
        overflow-y: auto;
      }
      model-viewer {
        width: 100%;
        height: 60vh;
      }

      @media (max-width: 600px) {
        model-viewer {
          height: 30vh;
        }
      }
      .buttons {
        margin: 10px;
      }
      button {
        padding: 10px 15px;
        margin: 5px;
        border-radius: 10px;
        border: none;
        background: #0077b6;
        color: white;
        cursor: pointer;
      }

      /* Styles pour les √©l√©ments de l'aquarium */
      .aquarium-elements {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* Permet d'interagir avec le model-viewer en dessous */
        z-index: 1; /* Assure que les √©l√©ments sont au-dessus du fond mais en dessous du model-viewer */
      }

      .bubble-container {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .bubble {
        position: absolute;
        background-color: rgba(
          255,
          255,
          255,
          0.5
        ); /* Bulles semi-transparentes */
        border-radius: 50%;
        animation: bubble-rise linear infinite;
      }

      @keyframes bubble-rise {
        0% {
          transform: translateY(100vh) scale(0);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        80% {
          opacity: 1;
        }
        100% {
          transform: translateY(-10%) scale(1.2);
          opacity: 0;
        }
      }

      /* Styles pour le panneau d'informations */
      .info-panel {
        background-color: rgba(0, 0, 0, 0.7); 
        color: white;
        padding: 20px;
        margin-top: 20px;
        border-top-left-radius: 20px;
        width: 50%;
        .info-panel h3 
        {
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.5em;
      }

    border-top-right-radius: 20px;
        text-align: left;
      }

      /* Styles pour le conteneur principal */
      .main-content-container {
        display: flex;
        flex-direction: column; /* Par d√©faut, empil√© pour mobile */
        width: 100%;
        height: 100vh; /* Ajuster la hauteur automatiquement */
      }

      .info-panel h3 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 1.5em;
      }

      .tabs {
        display: flex;
        justify-content: space-around;
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
      }

      .tab-button {
        background: none;
        border: none;
        color: rgba(255, 255, 255, 0.7);
        padding: 10px 15px;
        cursor: pointer;
        font-size: 1em;
        transition: color 0.3s, border-bottom 0.3s;
      }

      .tab-button.active {
        color: white;
        border-bottom: 2px solid white;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .buttons 
      {
        position: absolute;
        top: 8%;
        left: 82%;
        width: 16%;
      }

    </style>
  </head>
  <body>
    <div class="aquarium-elements">
      <div class="bubble-container"></div>
    </div>

    <div class="main-content-container">
      <model-viewer
        id="viewer"
        src="fish3.glb"
        ar
        ar-modes="scene-viewer quick-look webxr"
        camera-controls
        auto-rotate
        shadow-intensity="1"
        autoplay
      >
      </model-viewer>

      <div class="info-panel">
        <h3 id="fish-name"></h3>
        <div class="tabs">
          <button class="tab-button active" data-tab="overview">
            Overview
          </button>
          <button class="tab-button" data-tab="habitat">Habitat</button>
          <button class="tab-button" data-tab="diet">Diet</button>
          <button class="tab-button" data-tab="behavior">Behavior</button>
        </div>
        <div class="tab-content active" id="overview-content"></div>
        <div class="tab-content" id="habitat-content"></div>
        <div class="tab-content" id="diet-content"></div>
        <div class="tab-content" id="behavior-content"></div>
      </div>
    </div>
   
     <div class="buttons">
      <button onclick="changeModel('fish3.glb')">üêü Poisson Rouge</button>
      <button onclick="changeModel('bluePowderTang.glb')">
        üê† Poisson-Chirurgien Bleu
      </button>
      <button onclick="changeModel('ButterflyFish.glb')">
        ü¶ã Poisson-Papillon
      </button>
      <button onclick="changeModel('algues.glb')">üåø Algue</button>
    </div>
    

    <script>
      const modelViewerElement = document.getElementById("viewer");
      const urlParams = new URLSearchParams(window.location.search);
      const modelFromUrl = urlParams.get("model");
      const buttonsContainer = document.querySelector(".buttons");
      const allButtons = buttonsContainer.querySelectorAll("button");
      const infoPanel = document.querySelector(".info-panel");
      const fishNameElement = document.getElementById("fish-name");
      const tabButtons = document.querySelectorAll(".tab-button");
      const tabContents = document.querySelectorAll(".tab-content");

      // Donn√©es pour chaque mod√®le
      const modelData = {
        "fish3.glb": {
          name: "POISSON ROUGE",
          overview: `
          <p><b>Nom scientifique:</b> Carassius auratus</p>
          <p><b>Taille:</b> Environ 10-20 cm</p>
          <p><b>Dur√©e de vie:</b> 10-15 ans (en aquarium bien entretenu)</p>
          <p>Le poisson rouge est l'un des poissons d'aquarium les plus populaires au monde. Originaire d'Asie de l'Est, il a √©t√© domestiqu√© il y a plus de mille ans en Chine. Il est appr√©ci√© pour sa robustesse, sa vari√©t√© de formes et de couleurs, et sa facilit√© d'entretien, bien qu'il n√©cessite un espace suffisant pour s'√©panouir.</p>
        `,
          habitat: `<p>Historiquement, le poisson rouge est originaire des eaux douces et calmes d'Asie de l'Est, notamment en Chine et au Japon. Il pr√©f√®re les √©tangs, les lacs et les rivi√®res √† faible courant, avec une v√©g√©tation dense. En aquarium, il a besoin d'un environnement stable avec une bonne filtration et de l'espace pour nager.</p>`,
          diet: `<p>Le poisson rouge est omnivore avec une tendance herbivore. Dans la nature, il se nourrit d'algues, de plantes aquatiques, de petits insectes, de larves et de crustac√©s. En captivit√©, une alimentation √©quilibr√©e doit inclure des granul√©s ou flocons de haute qualit√© sp√©cifiques aux poissons rouges, compl√©t√©s par des l√©gumes blanchis (petits pois, √©pinards) et occasionnellement des prot√©ines comme des vers de vase ou des daphnies.</p>`,
          behavior: `<p>Les poissons rouges sont des cr√©atures paisibles et gr√©gaires. Ils aiment vivre en groupe et peuvent devenir tr√®s sociables avec leurs propri√©taires. Ils sont connus pour leur curiosit√© et leur capacit√© √† reconna√Ætre les personnes qui les nourrissent. Ils passent une grande partie de leur temps √† fouiller le substrat √† la recherche de nourriture.</p>`,
        },
        "bluePowderTang.glb": {
          name: "POISSON-CHIRURGIEN BLEU",
          overview: `
          <p><b>Nom scientifique:</b> Paracanthurus hepatus</p>
          <p><b>Taille:</b> Environ 20-30 cm</p>
          <p><b>Dur√©e de vie:</b> 8-20 ans</p>
          <p>Le poisson-chirurgien bleu, √©galement connu sous le nom de Dory dans le film "Le Monde de Nemo", est c√©l√®bre pour ses couleurs vives : un corps bleu √©lectrique, une queue jaune vif et une tache noire distinctive. C'est un poisson r√©cifal tr√®s actif qui joue un r√¥le important dans le maintien de la sant√© des r√©cifs coralliens en broutant les algues.</p>
        `,
          habitat: `<p>Le poisson-chirurgien bleu est largement r√©pandu dans les eaux tropicales de l'Indo-Pacifique, des Philippines √† la Grande Barri√®re de Corail. Il habite les zones riches en coraux des r√©cifs ext√©rieurs, o√π il trouve √† la fois abri et nourriture. Il pr√©f√®re les eaux claires et bien oxyg√©n√©es.</p>`,
          diet: `<p>C'est un herbivore strict, se nourrissant principalement d'algues filamenteuses et d'autres v√©g√©taux marins qu'il broute sur les rochers et les coraux. Cette habitude alimentaire est cruciale pour pr√©venir la prolif√©ration excessive d'algues qui pourrait √©touffer les coraux. En aquarium, son r√©gime doit √™tre compos√© majoritairement d'algues nori, de spiruline et d'aliments v√©g√©taux.</p>`,
          behavior: `<p>Le poisson-chirurgien bleu est un poisson diurne, tr√®s actif et nageur. Il peut √™tre territorial, surtout envers les autres poissons-chirurgiens ou les esp√®ces de forme similaire. Il est souvent observ√© en petits groupes ou en solitaire, se d√©pla√ßant constamment √† la recherche de nourriture. Il poss√®de des √©pines scalpel-aiguis√©es √† la base de sa queue, qu'il utilise pour se d√©fendre.</p>`,
        },
        "ButterflyFish.glb": {
          name: "POISSON-PAPILLON",
          overview: `
          <p><b>Nom scientifique:</b> Chaetodontidae (famille)</p>
          <p><b>Taille:</b> Environ 12-22 cm (selon l'esp√®ce)</p>
          <p><b>Dur√©e de vie:</b> 5-10 ans</p>
          <p>Les poissons-papillons sont un groupe diversifi√© de poissons marins tropicaux, reconnaissables √† leurs corps plats, leurs couleurs vives et leurs motifs audacieux, souvent avec une tache oculaire pour d√©router les pr√©dateurs. Ils ont un petit museau pointu, id√©al pour cueillir de petites proies ou brouter les coraux.</p>
        `,
          habitat: `<p>Les poissons-papillons habitent les r√©cifs coralliens tropicaux et subtropicaux du monde entier, principalement dans l'oc√©an Atlantique, Indien et Pacifique. Ils sont souvent trouv√©s dans les eaux peu profondes, riches en coraux, o√π ils peuvent trouver de la nourriture et des abris.</p>`,
          diet: `<p>Le r√©gime alimentaire des poissons-papillons varie consid√©rablement selon l'esp√®ce. Certains sont des corallivores stricts, se nourrissant exclusivement de polypes de coraux, tandis que d'autres sont omnivores, consommant des algues, des petits invert√©br√©s (vers, crustac√©s) et du zooplancton. Leur bouche sp√©cialis√©e leur permet d'acc√©der √† des sources de nourriture difficiles d'acc√®s.</p>`,
          behavior: `<p>La plupart des poissons-papillons sont diurnes et tr√®s actifs. Beaucoup d'esp√®ces vivent en couples monogames qui restent ensemble pendant de longues p√©riodes, voire toute leur vie. D'autres peuvent √™tre solitaires ou former de petits groupes. Ils sont g√©n√©ralement territoriaux et d√©fendent leur zone de nourrissage contre les intrus.</p>`,
        },
        "algues.glb": {
          name: "ALGUE",
          overview: `
          <p><b>Nom scientifique:</b> Divers (ex: Fucus, Laminaria, Caulerpa)</p>
          <p><b>Taille:</b> Variable, de quelques millim√®tres √† plusieurs dizaines de m√®tres</p>
          <p><b>Dur√©e de vie:</b> Variable, de quelques semaines √† plusieurs ann√©es</p>
          <p>Les algues sont des organismes photosynth√©tiques fondamentaux pour la vie marine. Elles ne sont pas des plantes au sens strict, mais elles jouent un r√¥le √©cologique similaire en produisant de l'oxyg√®ne et en servant de base √† de nombreuses cha√Ænes alimentaires aquatiques. Elles existent sous une incroyable diversit√© de formes, de tailles et de couleurs.</p>
        `,
          habitat: `<p>Les algues sont pr√©sentes dans presque tous les environnements aquatiques de la plan√®te, des oc√©ans polaires aux eaux tropicales, en passant par les lacs et les rivi√®res. Elles peuvent √™tre benthiques (fix√©es au fond) ou planctoniques (flottant librement). Leur r√©partition d√©pend de facteurs comme la lumi√®re, la temp√©rature, la salinit√© et la disponibilit√© des nutriments.</p>`,
          diet: `<p>Les algues sont autotrophes, ce qui signifie qu'elles produisent leur propre nourriture par photosynth√®se. Elles utilisent la lumi√®re du soleil, le dioxyde de carbone et les nutriments dissous dans l'eau pour cr√©er des sucres et de l'oxyg√®ne. Elles sont √† la base de la plupart des √©cosyst√®mes aquatiques.</p>`,
          behavior: `<p>Le "comportement" des algues est principalement li√© √† leur croissance et √† leur reproduction. Elles peuvent se reproduire de mani√®re asexu√©e (par fragmentation ou spores) ou sexu√©e. Certaines algues forment des for√™ts sous-marines denses (comme les kelps), offrant abri et nourriture √† une multitude d'organismes marins. D'autres peuvent prolif√©rer rapidement, formant des "blooms" algaux.</p>`,
        },
      };

      // Fonction pour mettre √† jour le mod√®le, les boutons et le panneau d'informations
      function updateModelAndButtons(modelName) {
        if (modelName) {
          modelViewerElement.setAttribute("src", modelName);
          // Cacher tous les boutons
          allButtons.forEach((button) => (button.style.display = "none"));
          // Afficher uniquement le bouton correspondant au mod√®le
          allButtons.forEach((button) => {
            if (button.onclick.toString().includes(`'${modelName}'`)) {
              button.style.display = "inline-block";
            }
          });

          // Mettre √† jour le panneau d'informations
          const data = modelData[modelName];
          if (data) {
            fishNameElement.textContent = data.name;
            document.getElementById("overview-content").innerHTML =
              data.overview;
            document.getElementById("habitat-content").innerHTML = data.habitat;
            document.getElementById("diet-content").innerHTML = data.diet;
            document.getElementById("behavior-content").innerHTML =
              data.behavior;

            // R√©initialiser les onglets √† 'Overview'
            tabButtons.forEach((button) => button.classList.remove("active"));
            tabContents.forEach((content) =>
              content.classList.remove("active")
            );
            document
              .querySelector('.tab-button[data-tab="overview"]')
              .classList.add("active");
            document.getElementById("overview-content").classList.add("active");
          }
        }
      }

      // G√©rer le changement d'onglet
      tabButtons.forEach((button) => {
        button.addEventListener("click", () => {
          tabButtons.forEach((btn) => btn.classList.remove("active"));
          button.classList.add("active");

          tabContents.forEach((content) => content.classList.remove("active"));
          const targetTab = button.dataset.tab;
          document
            .getElementById(`${targetTab}-content`)
            .classList.add("active");
        });
      });

      // Si un mod√®le est pass√© via l'URL, l'utiliser
      if (modelFromUrl) {
        updateModelAndButtons(modelFromUrl);
      } else {
        // Sinon, utiliser le mod√®le par d√©faut et afficher tous les boutons
        updateModelAndButtons(modelViewerElement.getAttribute("src")); // Utilise le src actuel comme mod√®le par d√©faut
        allButtons.forEach((button) => (button.style.display = "inline-block"));
      }

      // La fonction changeModel est toujours utile si on veut ajouter d'autres boutons plus tard
      function changeModel(model) {
        updateModelAndButtons(model);
      }

      // G√©n√©ration dynamique des bulles
      const bubbleContainer = document.querySelector(".bubble-container");

      function createBubble() {
        const bubble = document.createElement("div");
        bubble.classList.add("bubble");
        const size = Math.random() * 20 + 10; // Taille entre 10px et 30px
        bubble.style.width = `${size}px`;
        bubble.style.height = `${size}px`;
        bubble.style.left = `${Math.random() * 100}%`; // Position horizontale al√©atoire
        bubble.style.animationDuration = `${Math.random() * 6 + 4}s`; // Dur√©e d'animation entre 4s et 10s
        bubble.style.animationDelay = `${Math.random() * 2}s`; // D√©lai al√©atoire

        bubbleContainer.appendChild(bubble);

        // Supprimer la bulle apr√®s son animation pour √©viter d'encombrer le DOM
        bubble.addEventListener("animationend", () => {
          bubble.remove();
        });
      }

      // G√©n√©rer des bulles toutes les 300ms
      setInterval(createBubble, 300);
    </script>
  </body>
</html>
