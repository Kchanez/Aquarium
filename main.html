<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Aquarium AR</title>

    <script
      type="module"
      src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"
    ></script>

    <style>
      body {
        margin: 0;
        overflow: hidden;
        font-family: Arial, sans-serif;
        background: #001219;
      }
      #aquarium-bg {
        position: fixed;
        inset: 0;
        background: linear-gradient(#0077b6, #001219);
        z-index: 0;
      }
      #aquarium {
        position: relative;
        width: 100%;
        height: 100vh;
        z-index: 1;
      }
      .fish {
        position: absolute;
        width: 200px;
        height: 250px;
        pointer-events: none;
        z-index: 3;
        top: 40%;
        left: 20%;
      }
      .bubbles {
        position: fixed;
        inset: 0;
        z-index: 4; /* Temporairement augmenté pour le débogage */
        pointer-events: none;
      }

      .bubbles span {
        position: absolute;
        bottom: -50px;
        width: 10px;
        height: 10px;
        background: rgba(255, 255, 255, 0.4);
        border-radius: 50%;
        animation: rise linear infinite;
      }

      .bubbles span:nth-child(1) {
        left: 10%;
        animation-duration: 6s;
        width: 10px;
        height: 10px;
        opacity: 0.4;
      }
      .bubbles span:nth-child(2) {
        left: 20%;
        animation-duration: 9s;
        width: 12px;
        height: 12px;
        opacity: 0.5;
      }
      .bubbles span:nth-child(3) {
        left: 30%;
        animation-duration: 7s;
        width: 8px;
        height: 8px;
        opacity: 0.3;
      }
      .bubbles span:nth-child(4) {
        left: 40%;
        animation-duration: 10s;
        width: 14px;
        height: 14px;
        opacity: 0.6;
      }
      .bubbles span:nth-child(5) {
        left: 50%;
        animation-duration: 8s;
        width: 11px;
        height: 11px;
        opacity: 0.45;
      }
      .bubbles span:nth-child(6) {
        left: 60%;
        animation-duration: 11s;
        width: 9px;
        height: 9px;
        opacity: 0.35;
      }
      .bubbles span:nth-child(7) {
        left: 70%;
        animation-duration: 7.5s;
        width: 13px;
        height: 13px;
        opacity: 0.55;
      }
      .bubbles span:nth-child(8) {
        left: 80%;
        animation-duration: 9.5s;
        width: 10px;
        height: 10px;
        opacity: 0.4;
      }
      .bubbles span:nth-child(9) {
        left: 90%;
        animation-duration: 6.5s;
        width: 12px;
        height: 12px;
        opacity: 0.5;
      }

      @keyframes rise {
        from {
          transform: translateY(0) scale(0.5);
          opacity: 0;
        }
        to {
          transform: translateY(-110vh) scale(1);
          opacity: 1;
        }
      }
      .algae-3d {
        position: absolute;
        bottom: 0;
        height: 450px;
        width: 300px;
        z-index: 1;
      }
      .algae-3d model-viewer {
        width: 100%;
        height: 100%;
        --poster-color: transparent;
      }
      .algae-3d.left-algae {
        left: 27%;
        bottom: 25%;
      }
      .algae-3d.left-algae-2 {
        left: 15%;
        transform: scaleX(-1);
      }
      .algae-3d.right-algae {
        right: 5%;
        transform: scaleX(-1);
        bottom: 20%;
      }
      .algae-3d.right-algae-2 {
        right: 15%;
      }
      .algae-3d.center-left-algae {
        left: 30%;
        height: 200px;
        width: 120px;
        transform: scaleX(-1);
      }
      .algae-3d.center-right-algae {
        right: 30%;
        height: 220px;
        width: 130px;
      }
      .algae-3d.far-left-algae {
        left: 0%;
        height: 180px;
        width: 100px;
      }
      .algae-3d.far-right-algae {
        right: 0%;
        height: 200px;
        width: 110px;
        transform: scaleX(-1);
      }
      .algae-3d.mid-left-algae {
        left: 20%;
        height: 230px;
        width: 140px;
      }
      .algae-3d.mid-right-algae {
        right: 20%;
        height: 190px;
        width: 100px;
        transform: scaleX(-1);
      }
      .algae-3d.extra-left-algae {
        left: 10%;
        height: 170px;
        width: 90px;
        transform: scaleX(-1);
      }
      .algae-3d.extra-right-algae {
        right: 40%;
        height: 240px;
        width: 160px;
      }
      .algae-3d.far-left-algae-2 {
        left: 2%;
        height: 210px;
        width: 130px;
        transform: scaleX(-1);
      }
      .algae-3d.far-right-algae-2 {
        right: 15%;
        height: 170px;
        width: 90px;
      }
      #sand-model {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 400px;
        z-index: 1;
      }
      #sand-model model-viewer,
      #sand-model1 model-viewer,
      #sand-model2 model-viewer {
        width: 100%;
        height: 100%;
        --poster-color: transparent;
        transform: scaleX(11) scaleY(6);
      }
      #sand-model1 {
        position: fixed;
        right: 25%;
        width: 100%;
        z-index: 1;
        bottom: 45%;
        height: 20%;
      }

      #sand-model2 {
        position: fixed;
        left: 43%;
        width: 100%;
        z-index: 1;
        bottom: 30%;
        height: 20%;
      }
      #sandcastle-model {
        position: absolute;
        bottom: 0%; /* Ajustez la position au-dessus des algues */
        left: 43%;
        transform: translateX(-50%);
        height: 300px; /* Ajustez la hauteur */
        width: 300px; /* Ajustez la largeur */
        z-index: 2;
      }
      #sandcastle-model model-viewer {
        width: 100%;
        height: 100%;
        --poster-color: transparent;
      }
    </style>
  </head>

  <body>
    <!-- AQUARIUM AR 
    <div id="aquarium">-->
    <model-viewer
      class="fish"
      id="fish2"
      src="fish3.glb"
      ar
      ar-modes="quick-look webxr"
      camera-controls
      shadow-intensity="1"
    >
    </model-viewer>
    <!-- </div> -->
    <!-- FOND -->
    <div id="aquarium-bg"></div>

    <!-- BULLES -->
    <!--
    <div class="bubbles">
      <span></span><span></span><span></span><span></span><span></span
      ><span></span><span></span><span></span><span></span>
    </div>
    -->
    <!-- SABLE -->
    <!--
    <div id="sand-model">
      <model-viewer
        src="sable.glb"
        alt="Modèle 3D d'algues"
        shadow-intensity="1"
        camera-controls
        rotation-per-second="0deg"
        interaction-prompt="none"
        camera-orbit="0deg 75deg 100%"
        field-of-view="45deg"
      >
      </model-viewer>
    </div>
    -->

    <!-- ALGUES -->
    <!--
    <div id="sand-model1">
      <model-viewer
        src="algues.glb"
        alt="Modèle 3D d'algues"
        shadow-intensity="1"
        camera-controls
        rotation-per-second="0deg"
        interaction-prompt="none"
        camera-orbit="0deg 75deg 100%"
        field-of-view="45deg"
      >
      </model-viewer>
    </div>

    <div id="sand-model2">
      <model-viewer
        src="algues.glb"
        alt="Modèle 3D d'algues"
        shadow-intensity="1"
        camera-controls       
        rotation-per-second="0deg"
        interaction-prompt="none"
        camera-orbit="0deg 75deg 100%"
        field-of-view="45deg"
      >
      </model-viewer>
    </div>
    -->

    <!-- ROCHES -->
    <!--
    <div id="sandcastle-model">
      <model-viewer
        src="sandCastle.glb"
        alt="Modèle 3D de château de sable"
        camera-controls
        rotation-per-second="0deg"
        interaction-prompt="none"
        camera-orbit="0deg 75deg 100%"
        field-of-view="45deg"
      >
      </model-viewer>
    </div>
    -->

    <script>
      /* ===================== */
      /* ANIMATION POISSONS */
      /* ===================== */
      const fishes = [{ el: fish2, speed: 0.25, x: 500, dir: -1, wave: 2 }];

      function bounds() {
        return {
          left: window.innerWidth * 0.1,
          right: window.innerWidth * 0.9,
        };
      }

      function animate() {
        const b = bounds();

        fishes.forEach((f) => {
          let slow = 1;
          if (f.x > b.right - 120 || f.x < b.left + 120) {
            slow = 0.4;
          }

          f.x += f.speed * f.dir * slow;

          if (f.x >= b.right) f.dir = -1;
          if (f.x <= b.left) f.dir = 1;

          f.wave += 0.06; /* Vitesse de l'onde */
          const y = Math.sin(f.wave) * 20; /* Amplitude verticale */
          const rot = 0; /* Pas de rotation */

          f.el.style.transform = `
      translate(${f.x}px, ${y}px)
      scaleX(${f.dir})
    `;
        });

        requestAnimationFrame(animate);
      }

      animate();
    </script>
  </body>
</html>
