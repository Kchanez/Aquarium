<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>AR Viewer</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: linear-gradient(to bottom, #87ceeb, #1e90ff); /* Dégradé bleu pour l'eau */
      position: relative;
    }

    model-viewer {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 10;
    }

    .aquarium-elements {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none; /* Permet d'interagir avec le model-viewer en dessous */
        z-index: 5;
      }

      .bubble {
        position: absolute;
        background-color: rgba(255, 255, 255, 0.5);
        border-radius: 50%;
        /* opacity: 0; */ /* Supprimé pour permettre à l'animation de gérer l'opacité */
        animation: bubble-rise linear infinite;
      }

      @keyframes bubble-rise {
        0% {
          transform: translateY(100vh) scale(0.5); /* Commence en bas de l'écran */
          opacity: 0; /* Invisible au début */
        }
        20% {
          opacity: 0.8; /* Devient visible */
        }
        80% {
          opacity: 0.8; /* Reste visible */
        }
        100% {
          transform: translateY(-100vh) scale(1.5); /* Finit en haut de l'écran */
          opacity: 0; /* Disparaît à la fin */
        }
      }
  </style>
</head>
<body>
  <model-viewer
      id="ar-model-viewer"
      ar
      ar-modes="webxr scene-viewer quick-look"
      camera-controls
      shadow-intensity="1"
      auto-rotate
      autoplay
      animation-name="nager"
    ></model-viewer>

    <div class="aquarium-elements">
      <div class="bubble-container"></div>
    </div>

  <script>
      const modelViewer = document.getElementById("ar-model-viewer");
      const urlParams = new URLSearchParams(window.location.search);
      const model = urlParams.get("model");

      if (model) {
        modelViewer.src = model;
      }

      // Script pour générer les bulles
      const bubbleContainer = document.querySelector(".bubble-container");

      function createBubble() {
        const bubble = document.createElement("div");
        bubble.classList.add("bubble");
        const size = Math.random() * 20 + 10; // Taille entre 10px et 30px
        bubble.style.width = `${size}px`;
        bubble.style.height = `${size}px`;
        bubble.style.left = `${Math.random() * 100}%`; // Position horizontale aléatoire
        bubble.style.animationDuration = `${Math.random() * 6 + 4}s`; // Durée d'animation aléatoire entre 4s et 10s
        bubble.style.animationDelay = `${Math.random() * 4}s`; // Délai d'animation aléatoire
        bubbleContainer.appendChild(bubble);

        // Supprimer la bulle après son animation pour éviter l'encombrement du DOM
        bubble.addEventListener("animationend", () => {
          bubble.remove();
        });
      }

      // Générer des bulles à intervalles réguliers
      setInterval(createBubble, 300); // Crée une bulle toutes les 300ms
    </script>
</body>
</html>